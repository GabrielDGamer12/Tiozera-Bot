var request = require("request");
var fs = require("fs");
tokentwitch = (process.env.TOKENTWITCH)
twitchClientID = (process.env.twitch_client)

var options = { method: 'GET',
    url: 'https://api.twitch.tv/helix/streams/',
    qs: { game: 'Fortnite', offset: '0', limit: '2' },
    headers:
        { 
            'Client-ID': twitchClientID,
            'Authorization': tokentwitch
            } };

request(options, function (error, response, body) {
    if (error) throw new Error(error);
    fs.writeFile('./myfile.csv', body, { flag: 'w' }, function(err) {
        if (err)
            return console.error(err);
        fs.readFile('./myfile.csv', 'utf-8', function (err, data) {
            if (err)
                return console.error(err);
            console.log(JSON.parse(data));
        });
    });
});
